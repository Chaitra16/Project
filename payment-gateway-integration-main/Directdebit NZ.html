<!DOCTYPE html>
<html>
<head>
<meta name="viewport" 
   content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<!-- Zuora Public javascript library -->
<script type="text/javascript" src="https://static.zuora.com/Resources/libs/hosted/1.3.1/zuora-min.js"></script>

<script type = "text/javascript" src="Hpm.js"></script>  
  
<script>

   
// <!-- optional params in case prepopulation of certain fields is desired-->
// require('dotenv').config();
var prepopulateFields = {
   creditCardAddress1:"123 Any Street",
   creditCardAddress2:"Suite #999",
   creditCardCountry:"USA",
   creditCardHolderName:"John Doe"
};
 
// Sample params for rendering iframe on the client side
var params = {
   tenantId:46463,
   id:"8ad09fc2848a23a201848f718a447c4c", 
   // id: process.env.NEXT_PUBLIC_ZUORA_HOSTED_PAGE_ID,
   token:"v8HJXY8rl46t6CrgKnRfIhulBrgqCCKU",
   signature:"K1xLEm7ke8jUKhXJR5wO2Pt+08Ox9QgWbYKV5fSZ1Au6+ZrYL5u79gfdYC6QXB6UJH8iBZEVTp0cQ2j5H4qQ86E/sQcSyHT1gIwtzzUVKKEp9/N2EMchR0lFu/IvuvkpEMWUlefRbb2GBZMYCo6MDaNtojjLGBUjs1jmVuNkXq/09ijcwnHT0zD557jt6H7QsD3hRiZu/9aeyfEIfUQMTsHOZwJRVRUOLtEn7YKj7mNxZzThRTLJ1yK54QZus8JnaMc/UDW1lJuB8pSmzdwDDlAfR9NXhbJ32ZDjdMsde2liKlE5Z8pGzxWpEmsuGvcwYuQnnh8RDqg5pvZlc6kaug==",
   style:"inline",
   key:"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlOBATdUNHKTwWM0OZYl/vjHOugxOwjybsw+6u8Tddil/u1Z0drY3O2WV+Ff9KKzxLBm7Y51I1Ys3K+ztVttwcUh9qnic5IvW+/zFqDMwVwTODIbxtKXNBC1DwVdKjoq+VuG3BCC+89oIyK/L056cnA7DFGYHXekXM42jd2USCQeGa2oesjKZ/eQQgKSFomj9+NkfFMuA5RGMDcgSnN2ckFAdhU4Fij108x18GR5CXtvreOWkhv7Tsmt4mdVfm606nasdo7C6b256h6MGppJoMPRKh0+6T0aEkmDyjNRvnNA8CC4/O2PGj751UWqvujN37t7Ta8tKARpJrDAUUTALzwIDAQAB",
   submitEnabled:"true", 
   // url:`${process.env.NEXT_PUBLIC_ZUORA_PAYMENT_URL}/apps/PublicHostedPageLite.do`,
   // paymentGateway: process.env.NEXT_PUBLIC_ZUORA_PAYMENT_GATEWAY_NAME,
   // locale:"en_US", 
   // param_supportedTypes:"AmericanExpress,JCB,Visa,MasterCard,Discover,Dankort",
   url:"https://apisandbox.zuora.com/apps/PublicHostedPageLite.do", 
   paymentGateway:"Demo Test Gateway",//payment gateway name
   field_accountId: "8ad0877b848a10ae01848a6aeed143e9"
};

// 
// function callback(response) {
//    var redirectUrl = "";
//    if(response.success) {
//       alert("Success"); 
//    } 
//    else {
//       if(response.responseFrom == "Response_From_Submit_Page") {
//          // Handle the error response when the Payment Page submission failed.
//          alert("Failure");
//       }
//       else{
//          alert("Request failed");
//          // Handle the error response when the Payment Page request failed.
//         }
//    }
//    // window.location.replace(redirectUrl);
// }

function callback(response) {
    if (response.success) {
      // if (response.refId) {
      //   updateFormData({
      //     hpmCreditCardPaymentMethodId: response.refId,
      //   });
      // }
      alert("Success");
   }
     else {
      alert(
        'errorcode=' +
          response.errorCode +
          ', errorMessage=' +
          response.errorMessage
      );
    }
}


        
function loadHostedPage() {
   Z.setEventHandler("onloadCallback", function() {
      // do something when HPM iframe is loaded.
      // console.log("HPM page is Loaded");
      setLoading(false);
   });
//    console.log("Before");
   // Z.render(params,prepopulateFields,callback);
   Z.render(params,  prepopulateFields,callback);
//   console.log("after");
// alert("We are here");  
}
</script>
</head>
   <Body>   
            <form>  
               <input type = "button" onclick = "loadHostedPage()" value = "Create Credit Card Payment Method">   
            </form>       
   <div id="zuora_payment" ></div>
</body>
</html>
